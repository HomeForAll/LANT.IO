"use strict";function verificationOfRegistration(e){console.log("Проверяем регистрацию",e);var a=$(".main-message-block"),s=$('<div class="messageBlock">'+e+"</div>");a.prepend(s),setTimeout(function(){console.log("пошел таймер"),s.remove()},5e3)}function choiceBlock(e){if(!rootBlock)return!1;var a=$(".big-search-menu"),s=$(".big-search-menu-tenancy"),t=$("#blockToRent"),o=$("#Buy"),n=$(".search-menu-apartment");"toRent"===e?(t.css({background:"#5e9152"}).find("a").css({color:"#fff"}),o.css({background:"none"}).find("a").css({color:"#898989"}),a.css({display:"block"}),s.css({display:"none"})):(t.css({background:"none"}).find("a").css({color:"#898989"}),o.css({background:"#5e9152"}).find("a").css({color:"#fff"}),n.css({display:"none"}),a.css({display:"none"}),s.css({display:"block"}))}function showBigSearch(){var e=$(".big-search a i"),a=$(".big-search"),s=$(".search-menu-apartment"),t=$(".big-search-menu"),o=$(".big-search-menu-tenancy");return rootBlock=!0,choiceBlock(),s.css({display:"none"}),(productSearch=!productSearch)?(e.remove(),a.html('<i class="fa fa-angle-left" aria-hidden="true"></i><a>Простой поиск</a>'),t.css({display:"block"}),o.css({display:"none"}),s.css({display:"none"}),rootBlock=!0,productSearch=!0):(e.remove(),a.html('<a>Расширенный поиск</a><i class="fa fa-angle-right" aria-hidden="true"></i>'),s.css({display:"block"}),t.css({display:"none"}),o.css({display:"none"}),rootBlock=!1,productSearch=!1)}function showTopMenuAndSearch(){var e=$(".user");(showAndHideTopMenu=!showAndHideTopMenu)?(e.css({display:"block"}),showAndHideTopMenu=!0):(e.css({display:"none"}),showAndHideTopMenu=!1)}function filterOptionsApartments(){if(!(showFilter=!showFilter))return!1;blockFilterAndShadow.fadeIn("slow")}function allParam(e){switch($(".apartment-settings, .house-characteristics, .appearance-of-the-apartment, .appearance-of-the-build,.attachment, .document, .plot-of-land, .repair-and-utilities-of-home, .object-parameters,.additionally-ap, .main-ap, .furnishing,.repair-and-utilities-of-the-apartment").css({display:"none"}),e){case"apartment":var a=$(".apartment-settings");a.css({display:"block"}),$(".closeBlock").on("click",function(e){e.preventDefault(),a.fadeOut("slow")});break;case"houseCharacteristics":var s=$(".house-characteristics");s.css({display:"block"}),$(".close-house-characteristics").on("click",function(e){e.preventDefault(),s.fadeOut("slow").css({display:"none"})});break;case"apperanceOfTheApartment":var t=$(".appearance-of-the-apartment");t.css({display:"block"}),$(".search").on("click",function(e){e.preventDefault(),t.fadeOut("slow")});break;case"appearanceBuild":var o=$(".appearance-of-the-build");o.css({display:"block"}),$(".closeApparenceBuild").on("click",function(e){e.preventDefault(),o.fadeOut("slow")});break;case"attachment":var n=$(".attachment");n.css({display:"block"}),$(".closeAttachment").on("click",function(e){e.preventDefault(),n.fadeOut("slow")});break;case"document":var i=$(".document");i.css({display:"block"}),$(".closeDocument").on("click",function(e){e.preventDefault(),i.fadeOut("slow")});break;case"bigOption":var r=$(".showBigOptions"),l=$(".decorativeShadowBlock");r.css({display:"block"}),l.css({display:"block"}),$(".closeCurrency").on("click",function(e){e.preventDefault(),r.fadeOut("slow",function(){l.css({display:"none"})})});break;case"map":var c=$("#map");openMap||(yandexMap(),openMap=!0),$("#searchYandexMap").hide(),c.css({display:"block"}),$(".close-map").on("click",function(e){e.preventDefault(),$("#searchYandexMap").show(),c.fadeOut("slow")});break;case"plotOfLand":var d=$(".plot-of-land");d.css({display:"block"}),$(".close-plot-of-land").on("click",function(e){e.preventDefault(),d.fadeOut("slow")});break;case"repairAndUtilitiesOfHome":var p=$(".repair-and-utilities-of-home");p.css({display:"block"}),$(".close-repair-home").on("click",function(e){e.preventDefault(),p.fadeOut("slow")});break;case"objectParameters":var u=$(".object-parameters");u.css({display:"block"}),$(".close-object-parameters").on("click",function(e){e.preventDefault(),u.fadeOut("slow")});break;case"additionallyAp":var f=$(".additionally-ap");f.css({display:"block"}),$(".closeAdditionallyAp").on("click",function(e){e.preventDefault(),f.fadeOut("slow")});break;case"main":var m=$(".main-ap");m.css({display:"block"}),$(".closeMainAp").on("click",function(e){e.preventDefault(),m.fadeOut("slow")});break;case"furnishing":var g=$(".furnishing");g.css({display:"block"}),$(".closeFurnishing").on("click",function(e){e.preventDefault(),g.fadeOut("slow")});break;case"mainSettings":var h=$(".main-settings");h.css({display:"block"}),$(".closeMainSettings").on("click",function(e){e.preventDefault(),h.fadeOut("slow")});break;case"repairAndUtilitiesOfTheApartment":var v=$(".repair-and-utilities-of-the-apartment");v.css({display:"block"}),$(".close-repair-and-utilities-of-the-apartment").on("click",function(e){e.preventDefault(),v.fadeOut("slow")});break;case"buildingParametersFilter":var b=$(".building-parameters-filter");b.css({display:"block"}),$(".close-building-parameter").on("click",function(e){e.preventDefault(),b.fadeOut("slow")});break;default:console.log("Параметр не найден")}}function allFilterBlocks(e){var a,s=$(".value-text"),t={1:"Квартира",2:"Дом",3:"Комната",4:"Офисная площадь",5:"Отдельно стоящее здание",6:"Комплекс ОСЗ",7:"Земельный участок",8:"Гараж/машиноместо",9:"Рынок/Ярмарка",10:"Производственно-складские помещения",11:"Производственно-складские здания",12:"Недвижимость для туризма и отдыха"},o="";switch(s.empty(),$(".advanced-search-options").find(".building-parameters-apartment, .building-parameters-home, .building-parameters-room, .building-parameters-office-area,.building-parameters-separate-building, .building-parameters-ozs-сomplex,.test-7, .test-8, .test-9, .test-10, .test-11, .test-12, .test-13, .test-14").css({display:"none"}),e){case"searchMetroMainBlock":var n=$(".search-metro-main-block");n.css({display:"block"}),$(".closeSearchMetro").on("click",function(e){e.preventDefault(),n.hide("slow",function(){$(this).css({display:"none"})})});break;case"historySearch":var i=$(".exact-area");setInterval(function(){""===$(".history-text").val()?i.css({position:"relative",height:"75px",width:"37%",display:"inline-block"}):i.css({position:"absolute",height:"435px",width:"85%"})},1e3);break;case"1":$(".building-parameters-apartment").css({display:"flex"}),a=t[1];break;case"2":$(".building-parameters-home").css({display:"flex"}),a=t[2];break;case"3":$(".building-parameters-room").css({display:"flex"}),a=t[3];break;case"4":$(".building-parameters-office-area").css({display:"flex"}),a=t[4];break;case"5":$(".building-parameters-separate-building").css({display:"flex"}),a=t[5];break;case"6":$(".building-parameters-ozs-сomplex").css({display:"flex"}),a=t[6];break;case"7":$(".test-7").css({display:"flex"}),a=t[7];break;case"8":$(".test-8").css({display:"flex"}),a=t[8];break;case"9":$(".test-9").css({display:"flex"}),a=t[9];break;case"10":$(".test-10").css({display:"flex"}),a=t[10];break;case"11":$(".test-11").css({display:"flex"}),a=t[11];break;case"12":$(".test-12").css({display:"flex"}),a=t[12];break;default:console.log("Фильтр не настроен")}switch(e){case"val_1":case"val_2":case"val_3":case"val_4":o=a}s.prepend('<img src="../../template/images/apartments.png">'+o),blockFilterAndShadow.fadeOut("slow")}function quickSearch(e){var a=$(".quick-search");e.preventDefault(),a.css({display:"block"}),$(".closeQuickSearch").on("click",function(e){e.preventDefault(),a.fadeOut("slow")})}function moreAndLess(e){var a=$(".metro-location img");return valueButton[e](),imagesWidth>150?imagesWidth=150:imagesWidth<100?imagesWidth=100:void a.css({width:+imagesWidth+"%",height:+imagesWidth+"%"})}function closeFixedBlock(){$(".warning").css({display:"block"})}function renderAllApartments(e){var a="",s=$(".result-all-apartments");if(s.find("div",$(this).remove()),!e)return console.log("Данные не полные"),!1;for(var t=0;t<e.length;t++){var o=$("#entry-template").html(),n=Handlebars.compile(o);if(void 0===e[t].preview_img)return;e[t].preview_img=e[t].preview_img.split("|")[0],a+=n(e[t]),addNewRenderForm(e[t])}s.html(a)}function addNewRenderForm(){var e=$(".open-close-ad"),a=$(".result-all-apartments");a.prepend("#show-more-information"),e.on("click",function(){console.log("Отследили клик"),a.append("#entry-template")})}function yandexMap(){var e=$("#address");ymaps.ready(function(){var a=new ymaps.Map("map",{center:[55.76,37.64],zoom:10,controls:["fullscreenControl","typeSelector","geolocationControl","zoomControl"]});e.on("change",function(){ymaps.geocode(e.val()).then(function(e){var s=e.geoObjects.get(0);a.geoObjects.removeAll(),a.geoObjects.add(s);var t=s.properties.get("boundedBy"),o=s.geometry.getCoordinates(),n=s.getCountry(),i=s.getAdministrativeAreas()[0],r=s.getLocalities(),l=s.getThoroughfare(),c=s.getPremiseNumber();a.setBounds(t,{checkZoomRange:!0}),ymaps.geocode(MapController.prototype.coordinates,{kind:"district"}).then(function(e){var a;void 0===e.geoObjects.get(0)?a=void 0:s=(a=e.geoObjects.get(0)).properties.getAll().name;var s=a.properties.getAll().name;if("region"in MapController.options){var t=$(MapController.options.region),o=$("#region");t.text(""),t.text(s),o.val(""),o.val(s)}}),console.log(" --- Начало --- "),console.log("Адрес: "+s.getAddressLine()),console.log("Страна: "+n),console.log("Регион: "+i),console.log("Город: "+r),console.log("Улица: "+l),console.log("Дом №: "+c),console.log("Координаты: "+o),console.log(" --- Конец --- ")})}),window.suggests=new ymaps.SuggestView("address",{width:300,offset:[0,4],results:20})})}var productSearch,showAndHideTopMenu,boolean,rootBlock,showFilter,openMap=!1,blockFilterAndShadow=$(".property-type-apartment-settings, .decorativeShadowBlock"),imagesWidth=130,valueButton={more:function(){return imagesWidth+=10},less:function(){return imagesWidth-=10}};$(document).ready(function(){var e=io("http://91.202.180.160:8089?user_id=<?php echo $user_id; ?>&hash=<?php echo $hash; ?>"),a={1:"Зарегестрирован",2:"Не зарегистрирован"};e.disconnected?console.log("Нет подключения"):e.connected||console.log("Подключено"),verificationOfRegistration(e.uri?a[1]:a[2]),e.on("socket",function(e){JSON.stringify(e),console.log("Получили свежие бъявления",e)})}),verificationOfRegistration(),$(function(){setInterval(function(){var e=window.pageYOffset,a=$(".show-hide-header"),s=$(".header"),t=$(".show-and-hide-menu"),o=$(".user");e>500?(a.fadeOut(function(){s.css({background:"none"})}),t.css({display:"block"}),o.css({position:"fixed",top:"inherit",button:"inherit",right:"0"})):(a.fadeIn(function(){s.css({background:"linear-gradient(to top, rgba(255, 255, 255, 0), rgba(0, 0, 0, 0.72)"})}),t.css({display:"none"}),o.css({position:"fixed",bottom:"65px",top:"75px",right:"10px"}))},1e3)}),$(document).ready(function(){$.ajax({method:"POST",url:"/search",dataType:"Json",success:function(e){renderAllApartments(e)}})}),$("#scene").parallax({calibrateX:!1,calibrateY:!0,invertX:!1,invertY:!0,limitX:!1,limitY:10,scalarX:2,scalarY:8,frictionX:.2,frictionY:.8,originX:0,originY:1}),$("select").styler({selectSearch:!0}),$(document).ready(function(){$(".bxslider").bxSlider({slideWidth:500,minSlides:1,maxSlides:2,moveSlides:2,slideMargin:10,pager:!1,auto:!0,infiniteLoop:!0}),$(".bxslider-partners").bxSlider({slideWidth:150,minSlides:1,maxSlides:5,moveSlides:2,slideMargin:50,pager:!1,auto:!0,pause:15e3,infiniteLoop:!0}),$(".apartments-wallpapers").bxSlider({slideWidth:70,minSlides:1,maxSlides:5,moveSlides:3,slideMargin:0,pager:!1,pause:2e4,auto:!0,infiniteLoop:!0})}),$(".more-settings").on("click",function(){$(".show-more-settings").fadeIn("slow",$(this).css({display:"block"}))}),$(".select").on("click",function(e){var a=$(".jq-selectbox__trigger-arrow");e.preventDefault(),a.css({background:'url("../../template/images/pointer_top.png") center right 5px no-repeat',"background-size":"auto"}),setTimeout(function(){a.css({background:'url("../../template/images/pointer_bottom.png") center right 5px no-repeat',"background-size":"auto"})},5e3)}),$("#form_1").on("submit",function(){$(this).serialize(),renderAllApartments($(this))}),$("#form_2").on("submit",function(e){var a=$(this).serialize();e.preventDefault(),$.ajax({method:"POST",url:"/search",data:a,dataType:"Json",success:function(e){console.log("Собранные данные",e),renderAllApartments(e)},error:function(e){console.log("Ошибка отправки",e)}})}),$(function(){var e=$("#amountBefore"),a=$("#amountAfter"),s=$("#amountBeforeBy"),t=$("#amountAfterBy"),o=$("#amountBeforeSearch"),n=$("#amountAfterSearch"),i=$("#amountBeforeMain"),r=$("#amountAfterMain");e.val("0"),a.val("20000"),s.val("0"),t.val("20000"),o.val("0"),n.val("20000"),i.val("0"),r.val("20000"),$("#slider-range").slider({range:!0,min:0,max:2e7,values:[75,2e7],slide:function(s,t){e.val(t.values[0]),a.val(t.values[1])}}),$("#slider-range-buy").slider({range:!0,min:0,max:2e7,values:[75,2e7],slide:function(e,a){s.val(a.values[0]),t.val(a.values[1])}}),$("#slider-range-search").slider({range:!0,min:0,max:2e7,values:[75,2e7],slide:function(e,a){o.val(a.values[0]),n.val(a.values[1])}}),$("#main-slider").slider({range:!0,min:0,max:2e7,values:[75,2e7],slide:function(e,a){i.val(a.values[0]),r.val(a.values[1])}}),e.slider({values:0}),a.slider({values:1}),s.slider({values:0}),t.slider({values:1}),o.slider({values:0}),n.slider({values:1}),i.slider({values:0}),r.slider({values:1})}),ymaps.ready(function(){new ymaps.SuggestView("address",{width:300,offset:[0,4],results:20})});