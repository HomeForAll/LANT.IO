"use strict";function renderAllApartments(e){var o="",t=$(".result-all-apartments");if(!e)return console.log("Данные не полные"),!1;for(var n=0;n<e.length;n++){var a=$("#entry-template").html(),r=Handlebars.compile(a);e[n].preview_img="5.png",o+=r(e[n])}t.html(o)}function yandexMap(){var e=$("#address");ymaps.ready(function(){var o=new ymaps.Map("map",{center:[55.76,37.64],zoom:10,controls:["fullscreenControl","typeSelector","geolocationControl","zoomControl"]});e.on("change",function(){ymaps.geocode(e.val()).then(function(e){var t=e.geoObjects.get(0);o.geoObjects.removeAll(),o.geoObjects.add(t);var n=t.properties.get("boundedBy"),a=t.geometry.getCoordinates(),r=t.getCountry(),s=t.getAdministrativeAreas()[0],c=t.getLocalities(),l=t.getThoroughfare(),i=t.getPremiseNumber();o.setBounds(n,{checkZoomRange:!0}),ymaps.geocode(MapController.prototype.coordinates,{kind:"district"}).then(function(e){var o;void 0===e.geoObjects.get(0)?o=void 0:t=(o=e.geoObjects.get(0)).properties.getAll().name;var t=o.properties.getAll().name;if("region"in MapController.options){var n=$(MapController.options.region),a=$("#region");n.text(""),n.text(t),a.val(""),a.val(t)}}),console.log(" --- Начало --- "),console.log("Адрес: "+t.getAddressLine()),console.log("Страна: "+r),console.log("Регион: "+s),console.log("Город: "+c),console.log("Улица: "+l),console.log("Дом №: "+i),console.log("Координаты: "+a),console.log(" --- Конец --- ")})}),window.suggests=new ymaps.SuggestView("address",{width:300,offset:[0,4],results:20})})}var getSearchParameters=function(){var e=window.location.search.substr(1);return null!==e&&""!==e?function(e){for(var o={},t=e.split("&"),n=0;n<t.length;n++){var a=t[n].split("=");o[a[0]]=a[1]}return o}(e):{}};$(document).ready(function(){$.ajax({method:"GET",url:"api/search",data:getSearchParameters(),dataType:"Json",success:function(e){renderAllApartments(e)}})}),$("#form_2").on("submit",function(){var e={};$.ajax({method:"POST",url:"api/search",data:getSearchParameters(),success:function(o){renderAllApartments(o),e+=o}}),$(".open-close-ad").on("click",function(){var o="",t=$("#show-more-information").html(),n=Handlebars.compile(t),a=$(".result-all-apartments");o+=n(e),a.html(o)})}),$(function(){var e=$(".checkbox-4 input:checkbox");$(".checkbox-1 input:checkbox").on("click",function(e){$("#checkbox-price").html("От "+e.target.value)}),$(".checkbox-2 input:checkbox").on("click",function(e){$("#size-apartments").val(e.target.value)}),$(".checkbox-3 input:checkbox").on("click",function(e){$("#checkbox-area").html(e.target.value)}),e.on("change",function(){for(var t=[],n=0;n<e.length;n++){var a=e[n];$(a).prop("checked")&&(t[t.length]=$(a).val())}o(t)});var o=function(e){var o="";0===e.length&&(o="Выбрано (0)");for(var t=0;t<e.length;t++)o="Выбрано ("+e.length+")";$("#checkbox-equipment").html(o)}}),$(function(){var e=$("#amountBeforeMain"),o=$("#amountAfterMain");e.val("0"),o.val("20000"),$("#main-slider").slider({range:!0,min:0,max:2e7,values:[75,2e7],slide:function(t,n){e.val(n.values[0]),o.val(n.values[1])}}),e.slider({values:0}),o.slider({values:1})}),$(function(){setInterval(function(){var e=window.pageYOffset,o=$(".show-hide-header"),t=$(".header"),n=$(".show-and-hide-menu"),a=$(".user");e>500?(o.fadeOut(function(){t.css({background:"none"})}),n.css({display:"block"}),a.css({position:"fixed",top:"inherit",button:"inherit",right:"0"})):(o.fadeIn(function(){t.css({background:"linear-gradient(to top, rgba(255, 255, 255, 0), rgba(0, 0, 0, 0.72)"})}),n.css({display:"none"}),a.css({position:"fixed",bottom:"65px",top:"75px",right:"10px"}))},1e3)}),ymaps.ready(function(){new ymaps.SuggestView("address",{width:300,offset:[0,4],results:20})});